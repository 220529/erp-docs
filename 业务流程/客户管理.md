# 客户管理

## 客户状态流转

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           客户状态流转图                                     │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   ┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐ │
│   │ 新客户  │───▶│ 已量房  │───▶│ 已报价  │───▶│ 已签约  │───▶│ 已完工  │ │
│   │   NEW   │    │MEASURED │    │ QUOTED  │    │ SIGNED  │    │COMPLETED│ │
│   └─────────┘    └─────────┘    └─────────┘    └─────────┘    └─────────┘ │
│        │              │              │              │              │       │
│        ▼              ▼              ▼              ▼              ▼       │
│   ┌─────────────────────────────────────────────────────────────────┐     │
│   │                        客户跟进记录                              │     │
│   │  每次状态变更都应该有对应的跟进记录                               │     │
│   └─────────────────────────────────────────────────────────────────┘     │
│                                                                             │
│  状态说明：                                                                 │
│  • NEW: 新录入的客户，等待跟进                                              │
│  • MEASURED: 设计师已上门量房                                               │
│  • QUOTED: 已出方案并报价                                                   │
│  • SIGNED: 客户已签约，创建订单                                             │
│  • COMPLETED: 订单完工，客户服务结束                                        │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 客户字段

| 字段 | 说明 | 必填 |
|-----|------|-----|
| name | 客户姓名 | 是 |
| mobile | 手机号 | 是 |
| address | 地址 | 否 |
| area | 区域 | 否 |
| status | 客户状态 | 是 |
| designerId | 设计师 | 否 |
| remark | 备注 | 否 |

## API 接口

| 接口 | 方法 | 说明 |
|-----|------|-----|
| /api/customers | GET | 客户列表 |
| /api/customers/:id | GET | 客户详情 |
| /api/customers | POST | 创建客户 |
| /api/customers/:id | PUT | 更新客户 |
| /api/customers/:id | DELETE | 删除客户 |
| /api/customers/export | GET | 导出客户 |
| /api/customers/:id/follows | GET | 跟进列表 |
| /api/customers/:id/follows | POST | 添加跟进 |

## 业务规则

### 创建客户
1. 手机号不能重复
2. 初始状态为 `new`（新客户）
3. 自动记录创建人

### 状态变更
1. 状态只能按顺序流转
2. 变更状态时应添加跟进记录
3. 签约时自动创建订单

### 权限控制
| 操作 | 权限标识 | 角色 |
|-----|---------|-----|
| 查看列表 | customer:list | 所有角色 |
| 创建客户 | customer:create | 销售、管理员 |
| 编辑客户 | customer:update | 销售、管理员 |
| 删除客户 | customer:delete | 管理员 |
| 导出客户 | customer:export | 管理员 |

## 前端页面

| 路由 | 组件 | 功能 |
|-----|------|-----|
| /customer/list | features/customer/List.tsx | 客户列表、筛选、搜索、CRUD |
| /customer/detail/:id | features/customer/Detail.tsx | 客户详情、跟进记录、关联订单 |
