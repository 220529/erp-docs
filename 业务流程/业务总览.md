# 业务流程总览

## 核心业务流程

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           ERP 核心业务流程                                   │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   ┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐ │
│   │ 新客户  │───▶│ 已量房  │───▶│ 已报价  │───▶│ 已签约  │───▶│ 已完工  │ │
│   │  NEW    │    │MEASURED │    │ QUOTED  │    │ SIGNED  │    │COMPLETED│ │
│   └─────────┘    └─────────┘    └─────────┘    └────┬────┘    └─────────┘ │
│        │              │              │              │              ▲       │
│        ▼              ▼              ▼              ▼              │       │
│   ┌─────────────────────────────────────────────────────────────────┐     │
│   │                        客户跟进记录                              │     │
│   └─────────────────────────────────────────────────────────────────┘     │
│                                                    │                       │
│                                                    ▼                       │
│                                            ┌─────────────┐                 │
│                                            │  创建订单   │                 │
│                                            │  待签约     │                 │
│                                            └──────┬──────┘                 │
│                                                   │                        │
│   ┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐               │
│   │ 待签约  │───▶│ 已签约  │───▶│ 施工中  │───▶│ 已完工  │───────────────┘│
│   │ PENDING │    │ SIGNED  │    │IN_PROGRESS│   │COMPLETED│                 │
│   └─────────┘    └────┬────┘    └─────────┘    └─────────┘                 │
│                       │                                                     │
│                       ▼                                                     │
│               ┌─────────────┐                                              │
│               │  收款管理   │                                              │
│               │  多次收款   │                                              │
│               └─────────────┘                                              │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 业务模块

| 模块 | 功能 | 说明 |
|-----|------|-----|
| 客户管理 | 新增、跟进、状态流转 | 客户生命周期管理 |
| 订单管理 | 创建、材料、状态变更 | 订单全流程管理 |
| 收款管理 | 创建、确认、统计 | 财务收款管理 |
| 材料管理 | 材料库、分类、库存 | 材料信息维护 |
| 产品管理 | 产品定义、材料清单 | 产品方案管理 |

## 角色职责

```
┌─────────────────────────────────────────────────────────────────┐
│                         角色与职责                               │
├─────────────────────────────────────────────────────────────────┤
│  销售 (sales)     │ 录入客户、客户跟进、创建订单                 │
│  设计师 (designer) │ 量房、出方案、报价                          │
│  工长 (foreman)   │ 施工管理、材料领用、进度更新                 │
│  财务 (finance)   │ 收款确认、财务报表、成本核算                 │
│  管理员 (admin)   │ 系统配置、用户管理、权限分配                 │
└─────────────────────────────────────────────────────────────────┘
```

## 数据流转

### 客户 → 订单
```
1. 销售录入客户信息
2. 设计师量房、出方案
3. 客户确认方案，创建订单
4. 订单关联客户，继承客户信息
```

### 订单 → 收款
```
1. 订单签约后，可创建收款记录
2. 支持多次收款（首付、中期、尾款）
3. 财务确认收款，更新订单已收金额
4. 收款完成后，订单可完工
```

### 订单 → 材料
```
1. 订单添加所需材料
2. 材料从材料库选择
3. 计算订单成本金额
4. 材料出库记录
```

## 关键指标

| 类型 | 指标 |
|-----|------|
| 客户 | 新增客户数、转化率、跟进次数 |
| 订单 | 订单总额、数量、完成率 |
| 收款 | 收款总额、待收款、完成率 |
| 成本 | 材料成本、毛利率 |
